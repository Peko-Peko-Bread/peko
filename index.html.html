<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PekoPeko ‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏ô‡∏°‡πÄ‡∏°‡∏ô‡∏π</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f5f1e9;
      color: #4a3c31;
      padding: 20px;
      max-width: 500px;
      margin: 0 auto;
    }

    h1, h2, h3 {
      text-align: center;
      margin-bottom: 20px;
    }

    .page {
      display: none;
    }

    .active {
      display: block;
    }

    label {
      display: flex;
      align-items: center;
      background-color: #fffaf2;
      margin-bottom: 12px;
      padding: 10px 12px;
      border-radius: 6px;
      border: 1px solid #ddd0b4;
      font-size: 1rem;
    }

    input[type="radio"],
    input[type="checkbox"] {
      margin-right: 12px;
      transform: scale(1.2);
    }

    input[type="number"] {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border-radius: 4px;
      border: 1px solid #ccc;
      font-size: 1rem;
    }

    button {
      width: 100%;
      margin-top: 15px;
      padding: 12px;
      background-color: #f6aa1c;
      border: none;
      color: white;
      font-weight: bold;
      font-size: 1rem;
      cursor: pointer;
      border-radius: 6px;
    }

    button:hover {
      background-color: #d18e14;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      font-size: 0.95rem;
    }

    th, td {
      border: 1px solid #d3c7b1;
      padding: 10px;
      text-align: center;
    }

    th {
      background-color: #e6d4b8;
    }

    #qr-code {
      margin-top: 20px;
      text-align: center;
    }

    form {
      margin: 0;
      padding: 0;
    }

    @media screen and (max-width: 600px) {
      label, button, input[type="number"] {
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>

  <h1>üçû PekoPeko ‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏ô‡∏°‡πÄ‡∏°‡∏ô‡∏π</h1>

  <!-- Page 1: Bread Menu -->
  <div id="page1" class="page active">
    <form id="breadForm">
      <label><input type="radio" name="bread" value="‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏ô‡∏° 20" required> ‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏ô‡∏° - 20 ‡∏ö‡∏≤‡∏ó</label>
      <label><input type="radio" name="bread" value="‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏ô‡∏° - ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏• 20"> ‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏ô‡∏° - ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏• - 20 ‡∏ö‡∏≤‡∏ó</label>
      <label><input type="radio" name="bread" value="‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏ä‡πá‡∏≠‡∏Ñ‡πÇ‡∏Å‡πÅ‡∏•‡∏ï 20"> ‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏ä‡πá‡∏≠‡∏Ñ‡πÇ‡∏Å‡πÅ‡∏•‡∏ï - 20 ‡∏ö‡∏≤‡∏ó</label>
      <label><input type="radio" name="bread" value="‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢ 20"> ‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢ - 20 ‡∏ö‡∏≤‡∏ó</label>
      <label><input type="radio" name="bread" value="‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏Ñ‡∏≤‡∏£‡∏≤‡πÄ‡∏°‡∏• 20"> ‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏Ñ‡∏≤‡∏£‡∏≤‡πÄ‡∏°‡∏• - 20 ‡∏ö‡∏≤‡∏ó</label>
      <label><input type="radio" name="bread" value="‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡πÅ‡∏¢‡∏°‡∏™‡πâ‡∏° 20"> ‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡πÅ‡∏¢‡∏°‡∏™‡πâ‡∏° - 20 ‡∏ö‡∏≤‡∏ó</label>
      <label><input type="radio" name="bread" value="‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡πÅ‡∏¢‡∏°‡∏™‡∏ï‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡∏µ‡πà 20"> ‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡πÅ‡∏¢‡∏°‡∏™‡∏ï‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡∏µ‡πà - 20 ‡∏ö‡∏≤‡∏ó</label>
      <label><input type="radio" name="bread" value="‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡πÅ‡∏¢‡∏°‡∏ö‡∏•‡∏π‡πÄ‡∏ö‡∏≠‡∏£‡∏µ‡πà 20"> ‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡πÅ‡∏¢‡∏°‡∏ö‡∏•‡∏π‡πÄ‡∏ö‡∏≠‡∏£‡∏µ‡πà - 20 ‡∏ö‡∏≤‡∏ó</label>
      <label><input type="radio" name="bread" value="‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏ô‡∏π‡πÄ‡∏ó‡∏•‡∏•‡πà‡∏≤ 30"> ‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏ô‡∏π‡πÄ‡∏ó‡∏•‡∏•‡πà‡∏≤ - 30 ‡∏ö‡∏≤‡∏ó</label>
      <button type="button" id="toTopping">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ (Next)</button>
    </form>
  </div>

  <!-- Page 2: Topping Menu -->
  <div id="page2" class="page">
    <form id="toppingForm">
      <label><input type="checkbox" name="topping" value="‡πÇ‡∏≠‡∏£‡∏µ‡πÇ‡∏≠ 5"> ‡πÇ‡∏≠‡∏£‡∏µ‡πÇ‡∏≠ - 5 ‡∏ö‡∏≤‡∏ó</label>
      <label><input type="checkbox" name="topping" value="‡πÇ‡∏≠‡∏ß‡∏±‡∏•‡∏ï‡∏¥‡∏ô‡πÄ‡∏ü‡∏•‡∏Ñ 5"> ‡πÇ‡∏≠‡∏ß‡∏±‡∏•‡∏ï‡∏¥‡∏ô‡πÄ‡∏ü‡∏•‡∏Ñ - 5 ‡∏ö‡∏≤‡∏ó</label>
      <label><input type="checkbox" name="topping" value="‡πÄ‡∏¢‡∏•‡∏•‡∏µ‡πà‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏• 5"> ‡πÄ‡∏¢‡∏•‡∏•‡∏µ‡πà‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏• - 5 ‡∏ö‡∏≤‡∏ó</label>
      <label><input type="checkbox" name="topping" value="‡πÇ‡∏Å‡πÇ‡∏Å‡πâ‡∏Ñ‡∏£‡∏±‡πâ‡∏ô‡∏ä‡πå 5"> ‡πÇ‡∏Å‡πÇ‡∏Å‡πâ‡∏Ñ‡∏£‡∏±‡πâ‡∏ô‡∏ä‡πå - 5 ‡∏ö‡∏≤‡∏ó</label>
      <label><input type="checkbox" name="topping" value="‡∏Ñ‡∏≠‡∏£‡πå‡∏ô‡πÄ‡∏ü‡∏•‡∏Å‡∏™‡πå 5"> ‡∏Ñ‡∏≠‡∏£‡πå‡∏ô‡πÄ‡∏ü‡∏•‡∏Å‡∏™‡πå - 5 ‡∏ö‡∏≤‡∏ó</label>
      <label><input type="checkbox" name="topping" value="‡πÄ‡∏¢‡∏•‡∏•‡∏µ‡πà 5"> ‡πÄ‡∏¢‡∏•‡∏•‡∏µ‡πà - 5 ‡∏ö‡∏≤‡∏ó</label>
      <label><input type="checkbox" name="topping" value="‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï‡πÄ‡∏£‡∏ô‡πÇ‡∏ö‡∏ß‡πå 5"> ‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï‡πÄ‡∏£‡∏ô‡πÇ‡∏ö‡∏ß‡πå - 5 ‡∏ö‡∏≤‡∏ó</label>
      <label><input type="checkbox" name="topping" value="‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï‡∏™‡∏ï‡∏¥‡πä‡∏Å 5"> ‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï‡∏™‡∏ï‡∏¥‡πä‡∏Å - 5 ‡∏ö‡∏≤‡∏ó</label>
      <label><input type="checkbox" name="topping" value="‡∏°‡∏≤‡∏£‡πå‡∏ä‡πÅ‡∏°‡∏•‡πÇ‡∏•‡∏ß‡πå 5"> ‡∏°‡∏≤‡∏£‡πå‡∏ä‡πÅ‡∏°‡∏•‡πÇ‡∏•‡∏ß‡πå - 5 ‡∏ö‡∏≤‡∏ó</label>
      <label><input type="checkbox" name="topping" value="‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà 0"> ‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà</label>

      <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á: <input type="number" id="breadQuantity" name="breadQuantity" value="1" min="1" required></label>

      <button type="button" id="orderMore">‡∏™‡∏±‡πà‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏° (Order More)</button>
      <button type="button" id="toSummary">‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ (Summary)</button>
    </form>
  </div>

  <!-- Page 3: Summary and QR code -->
  <div id="page3" class="page">
    <h2>‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h2>
    <table id="orderTable">
      <thead>
        <tr>
          <th>‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á</th>
          <th>‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á</th>
          <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
          <th>‡∏£‡∏≤‡∏Ñ‡∏≤</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <h3>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤: <span id="totalPrice">0</span> ‡∏ö‡∏≤‡∏ó</h3>

    <label>‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (Add-up price): <input type="number" id="addUpPrice" name="addUpPrice" value="0" min="0"></label>

    <button type="button" id="orderMore2">‡∏™‡∏±‡πà‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏° (Order More)</button>

    <form id="confirmForm" action="https://formspree.io/f/xeozqaaw" method="POST">
      <input type="hidden" name="orders" id="ordersData" />
      <input type="hidden" name="addUpPrice" id="addUpPriceInput" />
      <button type="submit" id="confirmOrder">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ (Confirm Order)</button>
    </form>

    <div id="qr-code"></div>
  </div>

  <script>
    const page1 = document.getElementById('page1');
    const page2 = document.getElementById('page2');
    const page3 = document.getElementById('page3');

    const toToppingBtn = document.getElementById('toTopping');
    const orderMoreBtn = document.getElementById('orderMore');
    const orderMore2Btn = document.getElementById('orderMore2');
    const toSummaryBtn = document.getElementById('toSummary');

    const breadForm = document.getElementById('breadForm');
    const toppingForm = document.getElementById('toppingForm');
    const confirmForm = document.getElementById('confirmForm');

    let orders = [];

    function showPage(page) {
      page1.classList.remove('active');
      page2.classList.remove('active');
      page3.classList.remove('active');
      page.classList.add('active');
    }

    toToppingBtn.addEventListener('click', () => {
      if (!breadForm.bread.value) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á');
        return;
      }
      showPage(page2);
    });

    orderMoreBtn.addEventListener('click', () => {
      if (!toppingForm.breadQuantity.value || toppingForm.breadQuantity.value < 1) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á');
        return;
      }
      saveOrder();
      alert('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß!');
      showPage(page1);
      breadForm.reset();
      toppingForm.reset();
      toppingForm.breadQuantity.value = 1;
    });

    orderMore2Btn.addEventListener('click', () => {
      showPage(page1);
      breadForm.reset();
      toppingForm.reset();
      toppingForm.breadQuantity.value = 1;
    });

    toSummaryBtn.addEventListener('click', () => {
      if (!toppingForm.breadQuantity.value || toppingForm.breadQuantity.value < 1) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á');
        return;
      }
      saveOrder();
      showSummary();
      showPage(page3);
    });

    function saveOrder() {
      const breadSelected = breadForm.bread.value;
      let toppings = [];
      const toppingNodes = toppingForm.querySelectorAll('input[name="topping"]:checked');
      toppingNodes.forEach(node => {
        if (node.value.startsWith("‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà")) {
          toppings = [];
        } else {
          toppings.push(node.value);
        }
      });
      if (toppings.length === 0) toppings = ['‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà 0'];
      const quantity = parseInt(toppingForm.breadQuantity.value);
      orders.push({ bread: breadSelected, toppings, quantity });
    }

    function showSummary() {
      const tbody = document.querySelector('#orderTable tbody');
      tbody.innerHTML = '';
      let totalPrice = 0;

      orders.forEach(order => {
        const [breadName, breadPrice] = [order.bread.split(' ').slice(0, -1).join(' '), parseInt(order.bread.split(' ').slice(-1)[0])];
        const toppingNames = order.toppings.map(t => t.split(' ').slice(0, -1).join(' '));
        const toppingPrices = order.toppings.map(t => parseInt(t.split(' ').slice(-1)[0]));
        const toppingPriceSum = toppingPrices.reduce((a, b) => a + b, 0);
        const orderPrice = (breadPrice + toppingPriceSum) * order.quantity;
        totalPrice += orderPrice;

        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${breadName}</td><td>${toppingNames.join(', ')}</td><td>${order.quantity}</td><td>${orderPrice}</td>`;
        tbody.appendChild(tr);
      });

      const totalSpan = document.getElementById('totalPrice');
      const addUpInput = document.getElementById('addUpPrice');
      addUpInput.value = 0;
      totalSpan.textContent = totalPrice;
      addUpInput.oninput = () => {
        const addUp = parseInt(addUpInput.value) || 0;
        totalSpan.textContent = totalPrice + addUp;
      };
    }

    confirmForm.addEventListener('submit', e => {
      document.getElementById('ordersData').value = JSON.stringify(orders);
      document.getElementById('addUpPriceInput').value = document.getElementById('addUpPrice').value;
      orders = [];
    });

    function generateQRCode() {
      const qrDiv = document.getElementById('qr-code');
      qrDiv.innerHTML = '';
      const url = 'https://peko-peko-bread.github.io/peko/';
      const encoded = encodeURIComponent(url);
      const img = document.createElement('img');
      img.src = `https://chart.googleapis.com/chart?cht=qr&chs=200x200&chl=${encoded}`;
      img.alt = "QR Code";
      qrDiv.appendChild(img);
    }

    const observer = new MutationObserver(mutations => {
      mutations.forEach(mutation => {
        if (mutation.target.classList.contains('active') && mutation.target.id === 'page3') {
          generateQRCode();
        }
      });
    });

    observer.observe(page3, { attributes: true, attributeFilter: ['class'] });
  </script>
</body>
</html>
